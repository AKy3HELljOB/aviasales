{"version":3,"sources":["assets/logo.svg","components/Checkbox/Checkbox.jsx","reducers/filterReducer.js","containers/Filter/Filter.jsx","reducers/orderReducer.js","components/Switch/Switch.jsx","components/Ticket/Header/Header.jsx","components/Ticket/Segment/Segment.jsx","components/Ticket/Ticket.jsx","api/ticket/ticket.jsx","App.js","hooks/UseInterval/UseInterval.jsx","index.js"],"names":["Checkbox","onChange","checked","text","className","type","FilterContext","React","createContext","NONE","THREE","initState","all","none","one","two","three","reducer","state","action","updateAll","console","log","Error","Filter","useContext","filterState","dispatchFilter","values","key","map","e","target","OrderContext","CHEAPEST","FASTEST","selected","Switch","orderState","dispatchOrder","style","id","name","htmlFor","Header","x","price","carrier","toString","replace","src","alt","StopsCountString","count","formatNumber","number","formatTime","date","toLocaleString","timezone","hour","minute","calcTime","duration","msecStart","Date","parse","startDate","finishDate","InfoBlock","props","label","data","Info","origin","destination","stops","length","join","defaultProps","Ticket","Segment","segments","isOk","request","status","handleError","error","callback","errorCallback","a","fetch","res","json","then","getTickets","searchId","Tab","Tickets","tickets","ticket","App","useState","setSearchId","isLoaded","setIsLoaded","setTickets","currentTickets","setCurrentTickets","currentPageTickets","setCurrentPageTickets","useReducer","filterReducer","initFilterState","orderReducer","initOrderState","useEffect","getRequestId","delay","savedCallback","useRef","current","setInterval","clearInterval","useInterval","stop","filter","filterTickets","sort","b","compareFirst","compareSecond","compareDuration","comparePrice","slice","Provider","value","logo","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.2eb9fd45.chunk.js","sourcesContent":["export default __webpack_public_path__ + \"static/media/logo.8bb77c6b.svg\";","import React from \"react\";\nimport PropTypes from 'prop-types';\nimport \"./Checkbox.styles.css\";\n\nconst Checkbox = ({onChange, checked, text}) => (\n  <div>\n    <label className=\"checkbox\">\n      <input\n        type=\"checkbox\"\n        className=\"input visually-hidden\"\n        onChange={onChange}\n        checked={checked}\n      />\n      <span className=\"checked\" />\n      {text}\n    </label>\n  </div>\n);\n\nCheckbox.propTypes = {\n  onChange: PropTypes.func,\n  checked: PropTypes.bool,\n  text: PropTypes.string\n};\n\nexport default Checkbox;\n","import React from 'react'\n\nexport const FilterContext = React.createContext(null);\n\nexport const ALL = \"all\",\n  NONE = \"none\",\n  ONE = \"one\",\n  TWO = \"two\",\n  THREE = \"three\";\n\nexport const initState = {\n  all: true,\n  none: true,\n  one: true,\n  two: true,\n  three: true\n};\n\nexport const reducer = (state, action) => {\n  const updateAll = (state) => ({ ...state, all: state.none && state.one && state.two && state.three });\n\n  switch (action.type) {\n    case ALL:\n      return {\n        all: !state.all,\n        none: !state.all,\n        one: !state.all,\n        two: !state.all,\n        three: !state.all\n      };\n    case NONE:\n      return updateAll({ ...state, none: !state.none });\n    case ONE:\n      return updateAll({ ...state, one: !state.one });\n    case TWO:\n      return updateAll({ ...state, two: !state.two });\n    case THREE:\n      return updateAll({ ...state, three: !state.three });\n    default:\n      console.log(action.type);\n      throw new Error();\n  }\n} ","import React, { useContext } from \"react\";\nimport Checkbox from \"../../components/Checkbox/Checkbox\";\nimport {\n  FilterContext,\n  ALL,\n  NONE,\n  ONE,\n  TWO,\n  THREE,\n} from \"../../reducers/filterReducer\";\n\nconst Filter = () => {\n  const { filterState, dispatchFilter } = useContext(FilterContext);\n\nconst values = [\n  {text: \"Все\", checked: filterState.all, key: ALL},\n  {text: \"Без пересадок\", checked: filterState.none, key: NONE},\n  {text: \"1 пересадка\", checked: filterState.one, key: ONE},\n  {text: \"2 пересадки\", checked: filterState.two, key: TWO},\n  {text: \"3 пересадки\", checked: filterState.three, key: THREE}\n];\nconst makeCheckbox = ({text, checked, key}) => (\n  <Checkbox\n    key={key}\n    text={text}\n    checked={checked}\n    onChange={(e) => {console.log(e.target); dispatchFilter({ type: key })}}\n  />);\n\n  return (\n    <div className=\"filter\">\n      <h1>Количество пересадок </h1>\n      {values.map(makeCheckbox) }\n    </div>\n  );\n};\n\nexport default Filter;\n","import React from 'react'\n\nexport const OrderContext = React.createContext(null);\n\nexport const CHEAPEST = \"cheapest\",\n  FASTEST = \"fastest\";\n\nexport const initState = {\n  selected: CHEAPEST\n};\n\nexport const reducer = (state, action) => {\n  switch (action.type) {\n    case CHEAPEST:\n      return {\n        selected: CHEAPEST\n      }\n    case FASTEST:\n      return {\n        selected: FASTEST\n      };\n    default:\n      throw new Error();\n  }\n} ","import React, { useContext } from \"react\";\nimport { OrderContext, CHEAPEST, FASTEST } from \"../../reducers/orderReducer\";\nimport \"./Switch.styles.css\";\n\nconst Switch = () => {\n  const { orderState, dispatchOrder } = useContext(OrderContext);\n\n  const values = [\n    { key: CHEAPEST, style: \"button left\", text: \"Самый дешевый\" },\n    { key: FASTEST, style: \"button right\", text: \"Самый быстрый\" }\n  ];\n\n  const makeButton = ({ key, style, text }) => (\n    <span key={key}>\n      <input\n        type=\"radio\"\n        id={key}\n        name=\"order\"\n        checked={orderState.selected === key}\n        className=\"input visually-hidden\"\n        onChange={(e) => { dispatchOrder({ type: e.target.id})}}\n      />\n      <label htmlFor={key} className={style}>\n        {text}\n      </label>\n    </span>\n  );\n\n  return (\n    <div className=\"switch\">\n      <div>\n        {values.map(makeButton)}\n      </div>\n    </div>\n  );\n};\nexport default Switch;\n","import React from 'react';\nimport PropTypes from 'prop-types'\n\nimport './Header.styles.css';\nconst formatPrice = (x) => {\n  return x.toString().replace(/\\B(?=(\\d{3})+(?!\\d))/g, \" \")  + \" Р\";\n}\n\nconst logoSource = (name) => (`http://pics.avs.io/99/36/${name}.png`); \n\nconst Header = ({price, carrier}) => (\n  <div className=\"headerWrapper\">\n    <div className=\"price\">{formatPrice(price)}</div>\n    <span></span>\n    <span>\n      <img className=\"logo\" src={logoSource(carrier)} alt={carrier}></img>\n    </span>\n  </div>\n);\n\nHeader.propTypes = {\n  price: PropTypes.number,\n  carrier: PropTypes.string\n};\n\nexport default Header;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport './Segment.styles.css';\n\n\nconst StopsCountString = (count) => {\n  switch (count) {\n    case 0:\n      return \"Без пересадок\";\n    case 1:\n      return count + \" пересадка\";\n      case 2:\n      case 3:\n      case 4:\n      return count + \" пересадки\";\n    default:\n      return count + \" пересадок\";\n  }\n}\n\nconst formatNumber = (number) => ((number < 10 ? \"0\" : \"\") + number);\nconst formatTime = (date) => {\n  return date.toLocaleString(\"ru-RU\", { timezone: 'UTC', hour: 'numeric', minute: 'numeric'});\n}\n\nconst HOUR_TO_MIN = 60;\nconst formatDuration = (duration) => (formatNumber(~~(duration / HOUR_TO_MIN) + \"ч \" + formatNumber(duration % HOUR_TO_MIN) + \"м\"));\n\nconst calcTime = (date, duration) => {\n  const MIN_TO_MSEC = 60000;\n  const msecStart = Date.parse(date);\n  const startDate = new Date(msecStart);\n  const finishDate = new Date(msecStart + duration * MIN_TO_MSEC);\n  \n  return formatTime(startDate) + \" - \" + formatTime(finishDate);\n}\n\nconst InfoBlock = (props) => (\n  <div className=\"infoBlockWrapper\">\n    <div className=\"row1\" >{props.label}</div>\n    <div className=\"row2\" >{props.data} </div>\n  </div>\n);\n\nconst Info = (props) => (\n  <div className=\"infoWrapper\">\n    <div  className=\"column\" >\n      <InfoBlock\n        label={props.origin + \" - \" + props.destination}\n        data={calcTime(props.date, props.duration)}\n      />\n    </div>\n    <div  className=\"column\" >\n      <InfoBlock className=\"column\" \n        label=\"В пути\"\n        data={formatDuration(props.duration)}\n      />\n    </div>\n    <div  className=\"column\" >\n      <InfoBlock className=\"column\"\n        label={StopsCountString(props.stops.length)}\n        data={props.stops.join(\", \")}\n      />\n    </div>\n  </div>\n);\n\nInfo.propTypes = {\n  origin: PropTypes.string,\n  destination: PropTypes.string,\n  date: PropTypes.string,\n  duration: PropTypes.number,\n  stops: PropTypes.array\n};\n\nInfo.defaultProps = {\n  stops: []\n};\n\nexport default Info;\n","import React from 'react';\nimport PropTypes from 'prop-types'\nimport Header from './Header/Header' \nimport Segment from './Segment/Segment' \nimport './Ticket.styles.css';\n\nconst Ticket = (props) => (\n  <div className=\"ticket\">\n    <Header {...props}/>\n    <Segment {...props.segments[0]}/>\n    <Segment {...props.segments[1]}/>\n  </div>\n)\n\n Ticket.propTypes = {\n   segments: PropTypes.arrayOf(PropTypes.object)\n };\n\n Ticket.defaultProps = {\n   // bla: 'test',\n };\n\nexport default Ticket;","export function isOk(request) {\n  return request.status === 200;\n}\n\nexport function handleError(error, text, callback) {\n  return callback? callback(error) : console.log(text, error); \n}\nexport async function getRequestId(callback, errorCallback) {\n  try {\n    const res = await fetch(\"https://front-test.beta.aviasales.ru/search\");  \n    if (isOk(res)) {\n      res.json()\n        .then(res => callback(res) , e => handleError(e, \"getRequestId: \", errorCallback));\n    }\n  } catch(e) { handleError(e, \"getRequestId: \", errorCallback) };\n}\n\nexport async function getTickets(searchId, callback, errorCallback) {\n  if (searchId) {\n    try {\n      const res = await fetch(`https://front-test.beta.aviasales.ru/tickets?searchId=${searchId}`)    \n      if (isOk(res)) {\n        res.json()\n          .then(res => callback(res), e => handleError(e, \"getTickets: \", errorCallback))\n      }    \n    } catch(e) { handleError(e, \"getTickets: \", errorCallback) }; \n  }\n}\n\nexport default getTickets","import React, { useEffect, useState, useReducer } from 'react';\nimport logo from './assets/logo.svg';\nimport Filter from './containers/Filter/Filter'\nimport { FilterContext, reducer as filterReducer, initState as initFilterState } from './reducers/filterReducer'\nimport { OrderContext, reducer as orderReducer, initState as initOrderState, FASTEST } from './reducers/orderReducer'\nimport Switch from './components/Switch/Switch'\nimport Ticket from './components/Ticket/Ticket'\nimport useInterval from './hooks/UseInterval/UseInterval'\nimport { getRequestId, getTickets } from './api/ticket/ticket'\nimport './App.css';\n\nconst Tab = () => {\n  return (\n    <div className=\"tab\">\n      <Switch />\n    </div>\n  )\n}\nconst Tickets = (tickets) => {\n  let key=0;\n  return (tickets.length > 0 ?\n    <div className=\"tickets\">\n      {tickets.map((ticket) => (<Ticket {...ticket} key={key++}/>))}\n    </div>\n    :\n    null\n  );\n}\n\nexport const comparePrice = (a, b) => a.price - b.price;\n\nexport const compareDuration = (a, b) => {\n  const compareFirst = a.segments[0].duration - b.segments[0].duration;\n  const compareSecond = a.segments[1].duration - b.segments[1].duration;\n  if (compareFirst + compareSecond === 0)\n    return compareFirst;\n  return compareFirst + compareSecond;\n}\n\nexport const filterTickets = (ticket, filterState) => {\n  if (filterState.all)\n    return true;\n\n  const stopsCount = ticket.segments[0].stops.length + ticket.segments[1].stops.length;\n  switch (stopsCount) {\n    case 0:\n      return filterState.none;\n    case 1:\n      return filterState.one;\n    case 2:\n      return filterState.two;\n    case 3:\n      return filterState.three;\n    default:\n      return false;\n  }\n}\n\nfunction App() {\n  const [searchId, setSearchId] = useState();\n  const [isLoaded, setIsLoaded] = useState(false);\n  const [tickets, setTickets] = useState([]);\n  const [currentTickets, setCurrentTickets] = useState([]);\n  const [currentPageTickets, setCurrentPageTickets] = useState([]);\n  const [filterState, dispatchFilter] = useReducer(filterReducer, initFilterState);\n  const [orderState, dispatchOrder] = useReducer(orderReducer, initOrderState);\n  const TIMEOUT = 1000;\n\n  useEffect(\n    () => { getRequestId(res => setSearchId(res.searchId)) },\n    []);\n\n  useInterval(async () => {\n    const appendTickets = (res) => {\n      if (res.stop === true)\n        setIsLoaded(true);\n      setTickets([...tickets, ...res.tickets]);\n    }\n    getTickets(searchId, appendTickets);\n  }, isLoaded ? null : TIMEOUT);\n\n  useEffect(\n    () => setCurrentTickets(tickets.filter(ticket => filterTickets(ticket, filterState))),\n    [tickets, filterState]);\n    \n  useEffect(\n    () => { \n      const orderType = (a, b) => orderState.selected === FASTEST ? compareDuration(a, b) : comparePrice(a, b);\n      setCurrentTickets(currentTickets.sort(orderType)); \n      setCurrentPageTickets(currentTickets.slice(0, 5));},\n    [currentTickets, orderState]);\n\n  return (\n    <FilterContext.Provider value={{ dispatchFilter, filterState }}>\n      <OrderContext.Provider value={{ dispatchOrder, orderState }}>\n        <div className=\"app unselectable\">\n          <div className=\"appHeader\">\n            <img src={logo} alt=\"Aviasales logo\"/>\n          </div>\n          <div className=\"app-wrapper\">\n            <Filter />\n            <Tab />\n            {Tickets(currentPageTickets)}\n          </div>\n        </div>\n      </OrderContext.Provider>\n    </FilterContext.Provider>\n  );\n}\n\nexport default App;","import { useEffect, useRef } from 'react';\n\nexport default function useInterval(callback, delay) {\n  const savedCallback = useRef();\n\n  useEffect(() => {\n    savedCallback.current = callback;\n  }, [callback]);\n\n  useEffect(() => {\n    function tick() {\n      savedCallback.current();\n    }\n    if (delay != null) {\n      const id = setInterval(tick, delay);\n      return () => {\n        clearInterval(id);\n      }\n    }\n  }, [callback, delay])\n} \n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);"],"sourceRoot":""}